jQuery(function(a){function k(b){b.preventDefault();a("#yith_wcsc_receivers_panel").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});b={action:"print_receiver_row_action",index:a(".yith_wcsc_receiver_row").length};void 0!==yith_wcsc_receivers.context&void 0!==yith_wcsc_receivers.product_id&&(b.context=yith_wcsc_receivers.context,b.product_id=yith_wcsc_receivers.product_id);a.post(ajaxurl,b).success(function(c){a("#yith_wcsc_receivers_panel").find("table").find("tbody").append(c);
	a(".wc-customer-search, .wc-product-search").trigger("wc-enhanced-select-init");a("#yith_wcsc_receivers_panel").unblock()})}function h(){a("._receiver_order").each(function(b){a(this).val(b);a(this).trigger("change")})}(function(){a(".add_receiver_button").click(k);a("#yith_wcsc_receivers_panel").on("click",".remove_receiver",function(b){b.preventDefault();var c=a("#_data_to_remove");b=a(this).closest(".yith_wcsc_receiver_row");var g=b.attr("id"),d=a("#_receivers_"+g+"_ID").val();"new"!=d&&(0>c.val().split(",").indexOf(d)&&
(0==c.val().length?c.val(d):c.val(c.val()+","+d)),c.val(c.val().replace(",,",",")));c=new RegExp(g+",?");a("#_data_to_save").val(a("#_data_to_save").val().replace(c,""));b.remove();h()});a(".yith_wcsc_table_receivers").sortable({stop:function(b,c){h()}});a("#yith_wcsc_receivers_panel").on("click","._receiver_all_products_button",function(b){b.preventDefault();b=a(this).next("._receiver_all_products");1==b.val()?(b.attr("value","0"),a(this).removeClass("yith_wcsc_enabled")):(b.attr("value","1"),a(this).addClass("yith_wcsc_enabled"));
	b.trigger("change")});a(".save_receivers").click(function(b){b.preventDefault();b=a("#_data_to_save").val().split(",");var c=a("#_data_to_remove").val().split(","),g=a("._receiver").serialize();b="action=save_receivers_action&_receivers_to_save="+b+"&_receivers_to_remove="+c+"&"+g;a("#yith_wcsc_receivers_panel").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});a.post(ajaxurl,b).success(function(d){a("#_data_to_save").val("");a("#_data_to_remove").val("");for(var e=0;e<d.length;e++){var f=
	a("#_receivers_"+d[e].index+"_stripe_id");a("#_receivers_"+d[e].index+"_receiver_ID").val(d[e].id_receiver);f.val(d[e].stripe_id);"connect"===d[e].status_receiver&&(f.css("border","1px solid green"),f.css("color","black"),f.parent().next().find("._commission").attr("src",yith_wcsc_receivers.assets_url+"images/sc-icon-"+d[e].status_receiver+".svg"),f.parent().next().find("._commission").attr("title","Connected"))}a("#yith_wcsc_receivers_panel").unblock()})});a("#yith_wcsc_receivers_panel").on("change",
	"._receiver_all_products",function(){var b=a(this).closest(".option-product");1==a(this).val()?(b.find(".select2-selection__clear").trigger("mousedown"),b.find(".select2-selection__placeholder").text("All Products"),b.find("select").prop("disabled",!0)):(b.find("select").prop("disabled",!1),b.find(".select2-selection__placeholder").text("Search products"))});a("._receiver_all_products").trigger("change");a("#yith_wcsc_receivers_panel").on("change","._receiver",function(){var b=a("#_data_to_save"),
	c=a(this).closest(".yith_wcsc_receiver_row").attr("id");0>b.val().split(",").indexOf(c)&&(0==b.val().length?b.val(c):b.val(b.val()+","+c));a("#_data_to_save").val(a("#_data_to_save").val().replace(",,",","))})})()});