var stripe_card,stripe_exp,stripe_cvc,stripe=Stripe(yith_stripe_connect_info.public_key),element=stripe.elements(),type="undefined"!=typeof yith_stripe_connect_source_info?yith_stripe_connect_source_info.payment_type:"token";!function(e){function r(r){return!e("form.checkout, form#order_review, form#add_payment_method").is(".add-card")&&(!e("input#payment_method_yith-stripe-connect").is(":checked")||e('input[name="wc-yith-stripe-connect-payment-token"]').length&&"new"!=e('input[name="wc-yith-stripe-connect-payment-token"]:checked').val())||0!==e("input.stripe-token").length||0!==e("input.stripe-source").size()?r:("source"==type?(owner_info=n(),!1!==owner_info?stripe.createSource(stripe_card,n()).then(t):stripe.createSource(stripe_card).then(t),stripe.createSource(stripe_card,n()).then(t)):stripe.createToken(stripe_card).then(t),!1)}function t(r){var t=e("form.checkout, form#order_review, form#add_payment_method"),n=e("#wc-yith-stripe-connect-cc-form, #yith-stripe-connect-cc-form");if(r.error){if(e(".woocommerce-error, .stripe-token",n).remove(),t.unblock(),r.error.message)n.prepend('<ul class="woocommerce-error">'+r.error.message+"</ul>");else if("validation"===r.error.code){for(var i=r.error.fieldErrors,o=i.length,c="",a=0;a<o;a++)c+="<li>"+yith_stripe_connect_info[i[a]]+"</li>";n.prepend('<ul class="woocommerce-error">'+c+"</ul>")}}else"source"==type?n.append('<input type="hidden" class="stripe-source" name="stripe_connect_source" value="'+r.source.id+'"/>'):n.append('<input type="hidden" class="stripe-token" name="stripe_connect_token" value="'+r.token.id+'"/>'),t.submit()}function n(){var r={owner:{address:{}}},t=e("#yith-stripe-connect-card-name").length?e("#yith-stripe-connect-card-name").val():"",n=e("#billing_first_name").length?e("#billing_first_name").val():"",i=e("#billing_last_name").length?e("#billing_last_name").val():"",o=e("#billing_email").length?e("#billing_email").val():"",c=e("#billing_phone").length?e("#billing_phone").val():"",a=e("#billing_country").length?e("#billing_country").val():"",l=e("#billing_city").length?e("#billing_city").val():"",s=e("#billing_address_1").length?e("#billing_address_1").val():"",p=e("#billing_address_2").length?e("#billing_address_2").val():"",d=e("#billing_state").length?e("#billing_state").val():"",_=e("#billing_postcode").length?e("#billing_postcode").val():"";return""!==t?r.owner.name=t:(""!==n&&(r.owner.name=n),""!==i&&(r.owner.name+=""!==n?" "+i:i)),""!==r.owner.name&&(""!==o&&(r.owner.email=o),""!==c&&(r.owner.phone=c),""!==l&&(r.owner.address.city=l),""!==a&&(r.owner.address.country=a),""!==s&&(r.owner.address.line1=s),""!==p&&(r.owner.address.line2=p),""!==_&&(r.owner.address.postal_code=_),""!==d&&(r.owner.address.state=d),r)}e(function(){var t={base:{color:"#32325d",lineHeight:"18px",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}},n={focus:"focused",empty:"empty",invalid:"invalid"};stripe_card=element.create("cardNumber",{style:t,classes:n}),stripe_exp=element.create("cardExpiry",{style:t,classes:n}),stripe_cvc=element.create("cardCvc",{style:t,classes:n}),e(document.body).on("updated_checkout",function(){stripe_card.mount("#yith-card-number-field-wrapper"),stripe_exp.mount("#yith-card-expiry-field-wrapper"),stripe_cvc.mount("#yith-card-cvc-field-wrapper")}),e("form.checkout").on("checkout_place_order_yith-stripe-connect",function(e){return r(e)}),(e("form#add_payment_method").length>0||e("form#order_review").length>0)&&(stripe_card.mount("#yith-card-number-field-wrapper"),stripe_exp.mount("#yith-card-expiry-field-wrapper"),stripe_cvc.mount("#yith-card-cvc-field-wrapper"),e("form#add_payment_method, form#order_review").on("submit",function(e){return r(e)})),stripe_card.on("change",function(r){e("#yith-stripe-cc").attr("class","").addClass(r.brand)})})}(jQuery);